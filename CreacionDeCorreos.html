<!DOCTYPE html>
<html class="light" lang="es">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>VozDoc - Compositor de Correos por Voz</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#005A9C",
            "background-light": "#f6f7f8",
            "background-dark": "#101922",
            "primary-accent": "#50E3C2",
            "text-light": "#333333",
            "text-dark": "#E0E0E0",
            "surface-light": "#FFFFFF",
            "surface-dark": "#1A2836",
            "border-light": "#E0E0E0",
            "border-dark": "#2C3A47",
            "danger": "#DC3545"
          },
          fontFamily: {
            "display": ["Inter", "sans-serif"]
          },
          borderRadius: {
            "DEFAULT": "0.25rem",
            "lg": "0.5rem",
            "xl": "0.75rem",
            "full": "9999px"
          }
        }
      }
    }
  </script>
  <style>
    .material-symbols-outlined {
      font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    }

    #mail-body-wrapper {
      position: relative;
      transition: border-color 0.25s ease, box-shadow 0.4s ease, background-color 0.25s ease;
    }

    /* Placeholder para contenteditable */
    #email-body:empty::before {
      content: attr(data-placeholder);
      color: #9ca3af;
      pointer-events: none;
    }

    #mail-body-wrapper.listening-active {
      border-color: rgba(236, 72, 153, 0.45);
      box-shadow: 0 0 0 6px rgba(236, 72, 153, 0.18), 0 0 32px rgba(236, 72, 153, 0.28);
      animation: dictationAura 1.6s ease-in-out infinite;
    }

    @keyframes dictationAura {
      0% {
        box-shadow: 0 0 0 6px rgba(236, 72, 153, 0.18), 0 0 28px rgba(236, 72, 153, 0.22);
      }

      50% {
        box-shadow: 0 0 0 16px rgba(236, 72, 153, 0.14), 0 0 44px rgba(236, 72, 153, 0.32);
      }

      100% {
        box-shadow: 0 0 0 6px rgba(236, 72, 153, 0.18), 0 0 28px rgba(236, 72, 153, 0.22);
      }
    }

    .voice-chip {
      transition: transform 0.25s ease, box-shadow 0.35s ease, border-color 0.25s ease;
    }

    .voice-chip:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.12);
    }

    /* MEJORA: Asegurar que el sidebar no se desborde */
    #voice-sidebar {
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    @media (min-width: 1024px) {
      #voice-sidebar {
        min-width: 320px;
        /* Se elimina max-height para que flex lo gestione */
      }
    }

    .tab-button {
      padding: 8px 8px;
      cursor: pointer;
      font-size: 0.75rem;
      font-weight: 600;
      border-bottom: 3px solid transparent;
      margin-bottom: -1.5px;
      color: #6b7280;
      transition: all 0.15s ease-in-out;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      min-width: 0;
      flex-shrink: 1;
    }

    .tab-button:hover {
      color: #333333;
    }

    .tab-button.active {
      border-color: #005A9C;
      color: #005A9C;
    }

    .dark .tab-button {
      color: #9ca3af;
    }

    .dark .tab-button:hover {
      color: #E0E0E0;
    }

    .dark .tab-button.active {
      border-color: #005A9C;
      color: #E0E0E0;
    }
  </style>
</head>

<body class="h-screen bg-background-light dark:bg-background-dark font-display text-text-light dark:text-text-dark">

  <div class="flex h-full w-full flex-col overflow-hidden bg-background-light dark:bg-background-dark">

    <header
      class="flex w-full flex-shrink-0 items-center justify-between border-b border-solid border-border-light bg-background-light px-6 py-3 md:px-10 dark:border-border-dark dark:bg-background-dark">
      <div class="flex items-center gap-4">
        <svg class="h-6 w-6 text-primary" fill="currentColor" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
          <path clip-rule="evenodd"
            d="M12.0799 24L4 19.2479L9.95537 8.75216L18.04 13.4961L18.0446 4H29.9554L29.96 13.4961L38.0446 8.75216L44 19.2479L35.92 24L44 28.7521L38.0446 39.2479L29.96 34.5039L29.9554 44H18.0446L18.04 34.5039L9.95537 39.2479L4 28.7521L12.0799 24Z"
            fill-rule="evenodd"></path>
        </svg>
        <div>
          <h1 class="text-lg font-bold text-gray-900 dark:text-gray-100">VozDoc</h1>
          <p class="text-sm text-gray-500 dark:text-gray-400">Compositor de correos por voz</p>
        </div>
      </div>

      <div class="flex items-center gap-4">
        <div id="save-status" class="text-sm font-medium text-gray-500 dark:text-gray-300"></div>
        <button aria-label="Configuración"
          class="flex h-10 w-10 cursor-pointer items-center justify-center rounded-lg bg-slate-100 text-slate-900 transition-colors hover:bg-slate-200 dark:bg-surface-dark dark:text-white dark:hover:bg-border-dark">
          <span class="material-symbols-outlined">settings</span>
        </button>
        <div class="h-10 w-10 rounded-full bg-cover bg-center"
          style="background-image: url('https://i.pravatar.cc/40');" data-alt="Avatar de usuario">
        </div>
      </div>
    </header>

    <div class="flex w-full flex-1 overflow-hidden lg:flex-row lg:gap-10">

      <main class="flex flex-1 flex-col overflow-y-auto p-8">

        <div class="mx-auto flex h-full w-full max-w-3xl flex-col gap-8">

          <div id="help-box"
            class="relative flex-shrink-0 rounded-2xl border border-dashed border-primary/40 bg-primary/5 p-6 text-sm text-primary dark:border-primary/40 dark:bg-primary/10">
            <button id="help-box-close" type="button" aria-label="Ocultar ayuda"
              class="absolute right-3 top-3 p-1 text-primary/60 transition-colors hover:text-primary">
              <span class="material-symbols-outlined text-xl">close</span>
            </button>
            <h2 class="text-base font-semibold tracking-tight text-primary">¿Cómo funciona?</h2>
            <p class="mt-2 text-primary/80">
              El panel lateral te muestra los comandos disponibles para redactar y gestionar tu correo con la voz.
              Pronúncialos tal como aparecen para que VozDoc ejecute la acción.
            </p>
            <p class="mt-2 text-primary/80">
              Di <strong>"Ocultar ayuda"</strong> o <strong>"Entendido"</strong> para cerrar este panel.
            </p>
          </div>

          <div
            class="flex flex-1 flex-col rounded-3xl border border-border-light bg-surface-light p-8 shadow-sm dark:border-border-dark dark:bg-surface-dark">

            <div class="flex flex-1 flex-col space-y-6">
              <div class="space-y-2">
                <h2 class="text-2xl font-bold tracking-tight text-gray-900 dark:text-gray-100">Componer nuevo correo
                </h2>
                <p class="text-sm text-gray-600 dark:text-gray-400">Dicta los datos principales y VozDoc se encarga
                  del resto.</p>
              </div>

              <div class="flex flex-1 flex-col gap-5">

                <div class="grid grid-cols-[auto_1fr] items-center gap-4">
                  <label class="text-sm font-medium text-gray-700 dark:text-gray-300" for="email-to">Para</label>
                  <input id="email-to" type="email" autocomplete="off"
                    class="w-full rounded-xl border border-border-light bg-white px-4 py-3 text-base text-gray-900 shadow-sm transition focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20 dark:border-border-dark dark:bg-surface-dark dark:text-text-dark"
                    placeholder="Di 'Añadir destinatario'..." />
                </div>

                <div class="grid grid-cols-[auto_1fr] items-center gap-4">
                  <label class="text-sm font-medium text-gray-700 dark:text-gray-300" for="email-subject">Asunto</label>
                  <textarea id="email-subject" rows="1" autocomplete="off"
                    class="w-full resize-none rounded-xl border border-border-light bg-white px-4 py-3 text-base text-gray-900 shadow-sm transition focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20 dark:border-border-dark dark:bg-surface-dark dark:text-text-dark"
                    placeholder="Di 'Añadir asunto'..."></textarea>
                </div>

                <div class="flex flex-1 flex-col space-y-2">
                  <label class="text-sm font-medium text-gray-700 dark:text-gray-300" for="email-body">Mensaje</label>

                  <div id="mail-body-wrapper"
                    class="flex flex-1 rounded-2xl border-2 border-transparent bg-white transition dark:bg-surface-dark">

                    <div id="email-body" contenteditable="true" role="textbox" aria-multiline="true"
                      class="h-full w-full overflow-y-auto rounded-2xl bg-transparent px-5 py-5 text-base leading-relaxed text-text-light focus:outline-none dark:text-text-dark"
                      data-placeholder="Di 'Comenzar redacción' para dictar el cuerpo del correo..."></div>
                  </div>
                </div>

                <input id="attachment-input" type="file"
                  class="opacity-0 absolute inset-0 -z-10 w-1 h-1 overflow-hidden pointer-events-none"
                  aria-hidden="true" tabindex="-1" />

              </div>

            </div>
          </div>

        </div>
      </main>

      <aside id="voice-sidebar"
        class="flex w-full flex-col rounded-2xl border border-border-light bg-white/80 shadow-sm backdrop-blur dark:border-border-dark dark:bg-surface-dark/90 lg:w-[380px]">
        <div class="sticky top-6 flex h-full flex-col gap-4 px-6 py-6">

          <div class="flex flex-shrink-0 flex-col items-center gap-4 text-center">
            <div class="relative">
              <button id="dictation-toggle" aria-label="Activar dictado"
                class="flex h-20 w-20 items-center justify-center rounded-full bg-slate-200 text-primary shadow-sm transition-colors duration-200 ease-out focus-visible:outline-none focus-visible:ring-4 focus-visible:ring-primary/40">
                <span class="material-symbols-outlined text-4xl">mic</span>
              </button>
              <span id="sidebar-status-badge"
                class="absolute -bottom-2 left-1/2 -translate-x-1/2 rounded-full border border-border-light bg-white px-3 py-1 text-xs font-semibold uppercase tracking-wide text-gray-600 shadow-sm dark:border-border-dark dark:bg-surface-dark dark:text-gray-300">Inactivo</span>
            </div>
            <div class="flex flex-col gap-1">
              <p class="status-text text-base font-semibold text-gray-900 dark:text-gray-100">Escuchando comandos.</p>
              <p class="status-subtext hidden text-sm text-gray-600 dark:text-gray-400"></p>
            </div>
          </div>

          <div class="min-h-0 flex-1 space-y-4 overflow-y-auto">

            <div id="primary-command-chip" class="space-y-3">
              <div id="chip-command-start" data-command-chip data-command-label="Comenzar redacción"
                data-command-trigger="comenzar redacción|activar dictado|iniciar dictado"
                class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                <div class="flex items-start justify-between gap-3">
                  <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Comenzar redacción"</h3>
                  <button type="button"
                    class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                    data-command-toggle data-command-label="Comenzar redacción" aria-expanded="false"
                    aria-label="Mostrar descripción de Comenzar redacción">
                    <span class="material-symbols-outlined text-sm">help</span>
                  </button>
                </div>
                <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Activa el
                  dictado y comienza a escribir el correo.</p>
              </div>

              <div id="chip-command-stop" data-command-chip data-command-label="Terminar redacción"
                data-command-trigger="terminar redacción|detener dictado|parar dictado"
                class="voice-chip hidden rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                <div class="flex items-start justify-between gap-3">
                  <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Terminar redacción"</h3>
                  <button type="button"
                    class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                    data-command-toggle data-command-label="Terminar redacción" aria-expanded="false"
                    aria-label="Mostrar descripción de Terminar redacción">
                    <span class="material-symbols-outlined text-sm">help</span>
                  </button>
                </div>
                <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Detiene el
                  dictado y vuelve al modo de comandos.</p>
              </div>
            </div>

            <div id="sidebar-state-inactive" class="space-y-4">

              <div class="flex border-b border-border-light dark:border-border-dark">
                <button id="inactive-tab-btn-fields" data-tab-target="inactive-tab-panel-fields"
                  class="tab-button active flex-1 text-center" aria-selected="true">Campos</button>
                <button id="inactive-tab-btn-actions" data-tab-target="inactive-tab-panel-actions"
                  class="tab-button flex-1 text-center" aria-selected="false">Acciones</button>
                <button id="inactive-tab-btn-help" data-tab-target="inactive-tab-panel-help"
                  class="tab-button flex-1 text-center" aria-selected="false">Ayuda</button>
              </div>

              <div id="inactive-tab-panel-fields" class="space-y-2 tab-panel">
                <div data-command-chip data-command-label="Añadir destinatario"
                  data-command-trigger="añadir destinatario|modificar destinatario"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Añadir destinatario"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Añadir destinatario" aria-expanded="false"
                      aria-label="Mostrar descripción de Añadir destinatario">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Activa la
                    escucha para el campo 'Para'.</p>
                </div>
                <div data-command-chip data-command-label="Borrar destinatario"
                  data-command-trigger="borrar destinatario|eliminar destinatario"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Borrar destinatario"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Borrar destinatario" aria-expanded="false"
                      aria-label="Mostrar descripción de Borrar destinatario">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Limpia el
                    campo 'Para'.</p>
                </div>
                <div data-command-chip data-command-label="Añadir asunto"
                  data-command-trigger="añadir asunto|modificar asunto"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Añadir asunto"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Añadir asunto" aria-expanded="false"
                      aria-label="Mostrar descripción de Añadir asunto">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Activa la
                    escucha para el campo 'Asunto'.</p>
                </div>
                <div data-command-chip data-command-label="Borrar asunto"
                  data-command-trigger="borrar asunto|eliminar asunto"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Borrar asunto"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Borrar asunto" aria-expanded="false"
                      aria-label="Mostrar descripción de Borrar asunto">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Limpia el
                    campo 'Asunto'.</p>
                </div>
              </div>

              <div id="inactive-tab-panel-actions" class="space-y-2 tab-panel hidden">
                <div data-command-chip data-command-label="Adjuntar archivo"
                  data-command-trigger="adjuntar archivo|agregar archivo"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Adjuntar archivo"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Adjuntar archivo" aria-expanded="false"
                      aria-label="Mostrar descripción de Adjuntar archivo">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Abre el
                    selector de archivos para adjuntar documentos al correo.</p>
                </div>
                <div data-command-chip data-command-label="Enviar correo" data-command-trigger="enviar correo"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Enviar correo"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Enviar correo" aria-expanded="false"
                      aria-label="Mostrar descripción de Enviar correo">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Confirma
                    el envío del mensaje actual.</p>
                </div>
                <div data-command-chip data-command-label="Guardar borrador" data-command-trigger="guardar borrador"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Guardar borrador"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Guardar borrador" aria-expanded="false"
                      aria-label="Mostrar descripción de Guardar borrador">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Guarda tu
                    trabajo sin enviarlo todavía.</p>
                </div>
                <div data-command-chip data-command-label="Descartar correo"
                  data-command-trigger="descartar correo|eliminar correo|borrar correo"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Descartar correo"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Descartar correo" aria-expanded="false"
                      aria-label="Mostrar descripción de Descartar correo">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Limpia
                    todos los campos del formulario.</p>
                </div>
              </div>

              <div id="inactive-tab-panel-help" class="space-y-2 tab-panel hidden">
                <div data-command-chip data-command-label="Volver al inicio" data-command-trigger="volver al inicio"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Volver al inicio"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Volver al inicio" aria-expanded="false"
                      aria-label="Mostrar descripción de Volver al inicio">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Regresa
                    al panel principal del sistema.</p>
                </div>
                <div data-command-chip data-command-label="Ocultar ayuda"
                  data-command-trigger="ocultar ayuda|entendido|quitar ayuda|cerrar ayuda"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Ocultar ayuda"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Ocultar ayuda" aria-expanded="false"
                      aria-label="Mostrar descripción de Ocultar ayuda">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Cierra la
                    tarjeta de consejos inicial.</p>
                </div>
                <div data-command-chip data-command-label="Mostrar ayuda" data-command-trigger="mostrar ayuda|ver ayuda"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/70 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-start justify-between gap-3">
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Mostrar ayuda"</h3>
                    <button type="button"
                      class="inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 transition hover:text-primary focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
                      data-command-toggle data-command-label="Mostrar ayuda" aria-expanded="false"
                      aria-label="Mostrar descripción de Mostrar ayuda">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Vuelve a
                    abrir la sección de consejos para recordar los comandos básicos.</p>
                </div>
              </div>
            </div>

            <!-- === PANEL DE DICTADO (Idéntico a Documentos) === -->
            <div id="sidebar-state-dictating" class="hidden space-y-4">

              <!-- Pestañas: Puntuación | Formato | Corrección -->
              <div class="flex border-b border-border-light dark:border-border-dark">
                <button id="tab-btn-punctuation" data-tab-target="tab-panel-punctuation"
                  class="tab-button active flex-1 text-center" aria-selected="true">Puntuación</button>
                <button id="tab-btn-formatting" data-tab-target="tab-panel-formatting"
                  class="tab-button flex-1 text-center" aria-selected="false">Formato</button>
                <button id="tab-btn-editing" data-tab-target="tab-panel-editing" class="tab-button flex-1 text-center"
                  aria-selected="false">Corrección</button>
              </div>

              <!-- Panel 1: Puntuación -->
              <div id="tab-panel-punctuation" class="space-y-2 tab-panel">
                <!-- Agregar coma -->
                <div data-command-chip data-command-label="Agregar coma"
                  data-command-trigger="agregar coma|insertar coma|coma"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">more_horiz</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Agregar coma"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Agregar coma" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Inserta una
                    coma en la posición actual del cursor.</p>
                </div>

                <!-- Agregar punto -->
                <div data-command-chip data-command-label="Agregar punto"
                  data-command-trigger="agregar punto|insertar punto|punto"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">fiber_manual_record</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Agregar punto"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Agregar punto" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Cierra la
                    oración actual con un punto.</p>
                </div>

                <!-- Agregar nuevo párrafo -->
                <div data-command-chip data-command-label="Agregar nuevo párrafo"
                  data-command-trigger="agregar nuevo párrafo|nuevo párrafo|punto y aparte"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">keyboard_return</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Agregar nuevo párrafo"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Agregar nuevo párrafo" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Inserta un
                    salto de párrafo para cambiar de idea.</p>
                </div>
              </div>

              <!-- Panel 2: Formato -->
              <div id="tab-panel-formatting" class="hidden space-y-2 tab-panel">
                <!-- Activar negrita -->
                <div data-command-chip data-command-label="Activar negrita"
                  data-command-trigger="activar negrita|poner negrita"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">format_bold</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Activar negrita"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Activar negrita" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">El texto
                    que dictes a partir de ahora estará en negrita.</p>
                </div>

                <!-- Desactivar negrita -->
                <div data-command-chip data-command-label="Desactivar negrita"
                  data-command-trigger="desactivar negrita|quitar negrita"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">format_bold</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Desactivar negrita"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Desactivar negrita" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">El texto
                    dejará de estar en negrita.</p>
                </div>

                <!-- Activar cursiva -->
                <div data-command-chip data-command-label="Activar cursiva"
                  data-command-trigger="activar cursiva|poner cursiva"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">format_italic</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Activar cursiva"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Activar cursiva" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">El texto
                    que dictes a partir de ahora estará en cursiva.</p>
                </div>

                <!-- Desactivar cursiva -->
                <div data-command-chip data-command-label="Desactivar cursiva"
                  data-command-trigger="desactivar cursiva|quitar cursiva"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">format_italic</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Desactivar cursiva"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Desactivar cursiva" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">El texto
                    dejará de estar en cursiva.</p>
                </div>

                <!-- Activar subrayado -->
                <div data-command-chip data-command-label="Activar subrayado"
                  data-command-trigger="activar subrayado|poner subrayado"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">format_underlined</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Activar subrayado"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Activar subrayado" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">El texto
                    que dictes a partir de ahora estará subrayado.</p>
                </div>

                <!-- Desactivar subrayado -->
                <div data-command-chip data-command-label="Desactivar subrayado"
                  data-command-trigger="desactivar subrayado|quitar subrayado"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">format_underlined</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Desactivar subrayado"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Desactivar subrayado" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">El texto
                    dejará de estar subrayado.</p>
                </div>
              </div>

              <!-- Panel 3: Corrección -->
              <div id="tab-panel-editing" class="hidden space-y-2 tab-panel">
                <!-- Deshacer -->
                <div data-command-chip data-command-label="Deshacer" data-command-trigger="deshacer|undo"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">undo</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Deshacer"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Deshacer" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Revierte la
                    última acción realizada.</p>
                </div>

                <!-- Borrar última palabra -->
                <div data-command-chip data-command-label="Borrar última palabra"
                  data-command-trigger="borrar última palabra|eliminar última palabra"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">backspace</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Borrar última palabra"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Borrar última palabra" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Elimina la
                    última palabra que dictaste.</p>
                </div>

                <!-- Borrar oración -->
                <div data-command-chip data-command-label="Borrar oración"
                  data-command-trigger="borrar oración|eliminar oración"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">delete_sweep</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Borrar oración"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Borrar oración" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Elimina la
                    última oración completa.</p>
                </div>

                <!-- Borrar último párrafo -->
                <div data-command-chip data-command-label="Borrar último párrafo"
                  data-command-trigger="borrar último párrafo|eliminar último párrafo"
                  class="voice-chip rounded-2xl border border-border-light/70 bg-white/80 p-3 text-left shadow-sm dark:border-border-dark/70 dark:bg-white/5">
                  <div class="flex items-center gap-3">
                    <span class="material-symbols-outlined text-gray-500 dark:text-gray-400">delete</span>
                    <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">"Borrar último párrafo"</h3>
                    <button type="button"
                      class="ml-auto inline-flex h-6 w-6 items-center justify-center rounded-full border border-transparent text-gray-400 hover:text-primary transition-colors"
                      data-command-toggle data-command-label="Borrar último párrafo" aria-expanded="false">
                      <span class="material-symbols-outlined text-sm">help</span>
                    </button>
                  </div>
                  <p data-command-description class="mt-1.5 hidden text-xs text-gray-600 dark:text-gray-400">Elimina el
                    último párrafo completo.</p>
                </div>
              </div>

            </div>
          </div>

        </div>
      </aside>

    </div>
  </div>
  <script type="module" src="assets/js/pages/mailComposerPage.js"></script>
</body>

</html>